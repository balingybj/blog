# 模板

模板是一个 C++ 实体，用于定义一下五种内容之一：

- 类族（类模板），可以是嵌套类
- 函数族（函数模板），可以使成员方法
- 一族类型的别名（别名模板）（since C++11）
- 一族变量（变量模板）（since C++14）
- 一个概念（约束和概念）（since C++20）

模板可以有一个或多个模板参数，这些参数分为三种类型：类型模板参数，无类型模板参数，模板模板参数。

如果提供了模板参数，或者是可以推导的函数和类（since C++17）模板，则将其替换为特定类型或特定的函数左值以获得模板参数特化。还可以显示提供模板特化：类模板允许完成特化和部分特化，函数模板允许完全特化。

当在某个需要对象完整类型的上下文中引用类模板特化，或在某个需要方法定义存在的上下文中引用函数模板特化时，模板被实例化（模板的代码被编译），除非模板已经显示特化或实例化。类模板的实例化，不会实例化它的任何成员方法，除非这些成员方法被调用。链接时，不同编译单元生成的相同实例被合并。

模板的定义必须在其隐式实例化时可见，这也是为什么模板库通常在头文件中提供所有模板定义。

## 语法

模板的语法有以下三种形式：

- ```c++
    template <参数列表> 要求子句(since C++20)(可选) 声明
    ```

- ```c++
    export template <参数列表> 声明   // until C++11
    ```

- ```c++
    template <参数列表> concept 约束名称= 约束表达式   // since C++20
    ```

参数列表：逗号隔开的模板参数列表，每个参数可以是：非类型参数，类型参数，模板参数，或者前面这些组成的参数包。

声明可以是一下内容的声明：

- 类、结构体、联合
- 成员类或成员枚举类型
- 函数或成员方法的声明
- 命名空间中的静态数据成员
- 类作用域中的变量或静态数据成员（since C++14）
- 别名模板
- 或者是模板特化

要求子句：模板参数后面可以跟一个可选的要求子句，用于指定模板参数上的约束。

约束名称，约束表达式： 参见 [约束和概念](https://en.cppreference.com/w/cpp/language/constraints)(since C++20)

export（until C++11）：export 是一个可选的修饰符，声明模板为导出（当和类模板一起使用时，该类模板的所有成员都被导出）。实例化导出模板的文件不需要包含模板的定义，有声明就够了。支持 export 编译器很少，而且细节上存在分歧。





